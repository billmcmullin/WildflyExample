<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>Calculator</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 720px;
            margin: 24px;
        }

        label,
        input,
        select,
        button {
            display: block;
            margin: 8px 0;
        }

        .result {
            margin-top: 12px;
            padding: 8px;
            background: #f6f6f6;
            border: 1px solid #ddd;
        }
    </style>
</head>

<body>
    <h1>Calculator</h1>

    <label> A: <input id="a" type="text" value="2" /> </label>

    <label> B: <input id="b" type="text" value="3" /> </label>

    <label> Operation: <select id="op">
            <option value="add">add</option>
            <option value="sub">sub</option>
            <option value="mul">mul</option>
            <option value="div">div</option>
        </select> </label>

    <button id="calcBtn">Calculate</button>

    <div class="result" id="result" aria-live="polite"></div>

    <script> document.addEventListener('DOMContentLoaded', function () {
            var resultEl = document.getElementById('result'); var aEl = document.getElementById('a'); var bEl = document.getElementById('b'); var opEl = document.getElementById('op'); var btn = document.getElementById('calcBtn');

            function show(msg) {
                resultEl.textContent = msg;
            }

            btn.addEventListener('click', function () {
                var a = aEl.value;
                var b = bEl.value;
                var op = opEl.value;

                var params = 'a=' + encodeURIComponent(a) + '&b=' + encodeURIComponent(b) + '&op=' + encodeURIComponent(op);
                var url = '/api/calc?' + params;

                fetch(url, { method: 'GET' })
                    .then(function (response) {
                        return response.json().then(function (data) {
                            return { ok: response.ok, body: data };
                        });
                    })
                    .then(function (result) {
                        if (!result.ok) {
                            show('Error: ' + (result.body && result.body.error ? result.body.error : 'Unknown'));
                        } else {
                            var r = result.body.result !== undefined ? result.body.result : JSON.stringify(result.body);
                            show('Result: ' + r);
                        }
                    })
                    .catch(function (err) {
                        console.error(err);
                        show('Network or server error');
                    });
            });
        });

    </script>
</body>

</html>